<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>文章列表</title>
</head>
<link href="/simpleBook/css/postList.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="/simpleBook/js/layui/css/layui.css" media="all">
<script src="/simpleBook/js/laydate/laydate.js" type="application/javascript"></script>
<script src="/simpleBook/js/layui/layui.js" charset="utf-8"></script>
<script src="/simpleBook/js/jquery-1.12.4.min.js"></script>

<!--右边工具栏-->
<script type="text/html" id="opr">
    <a class="layui-btn layui-btn-xs" lay-event="edit" id="updatePost">编辑</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del" id="delPost">删除</a>
</script>
<!--左边工具栏-->
<script type="text/html" id="opr_left">
    <div class="layui-btn-group">
        <button type="button" class="layui-btn" id="delAll" lay-event="delAll">删除已选中</button>
    </div>
</script>
<!--主题名称-->
<script type="text/html" id="topic_temp">
    {{d.topic.name}}
</script>

<script type="application/javascript">
    // 使用layui的table控件，显示数据
    layui.use(['table', 'form', 'laydate'], function () {
        var table = layui.table,
            form = layui.form,
            laydate = layui.laydate;
        // 渲染时间
        laydate.render({
            elem: '#startDate' //指定元素
        });
        laydate.render({
            elem:"#endDate"
        });
        // 显示表格
        table.render({
            elem: '#postList'
            , title: "文章列表"
            , url: '/simpleBook/json/postJson.json'
            , toolbar: '#opr_left' //开启头部工具栏，并为其绑定左侧模板
            , layEvent: 'LAYTABLE_TIPS'
            , cellMinWidth: 80 //全局定义常规单元格的最小宽度，layui 2.2.1 新增
            , cols: [[
                {type: 'checkbox', fixed: 'left'}
                , {field: 'pid', width: 80, title: 'ID', sort: true}
                , {field: 'uid', width: 100, title: '用户编号'}
                , {
                    field: 'start',
                    width: 120,
                    title: '点赞/浏览',
                    sort: true,
                    templet: "<span>{{(d.start+d.readCount)*10}}</span>"
                }
                , {field: 'gratuity', width: 100, title: '打赏金额'}
                , {field: 'title', title: '标题', width: '30%', minWidth: 100} //minWidth：局部定义当前单元格的最小宽度，layui 2.2.1 新增
                , {field: 'sendDate', title: '发布时间', sort: true}
                , {field: 'hot', title: '热度', sort: true}
                , {field: 'status', title: '状态'}
                , {field: 'topic', width: 120, title: '主题', templet: "#topic_temp"}
                , {fixed: 'right', title: '操作', toolbar: '#opr', width: 150}
            ]]
            , page: true
        });

        //监听行工具事件
        table.on('tool(post_opr)', function (obj) {
            var data = obj.data;
            if (obj.event === 'del') {
                layer.alert(JSON.stringify(data))
            } else if (obj.event === 'edit') {
                layer.open({
                    type: 0
                    , content: JSON.stringify(data).toString()
                });
            }
        });

        // 删除已选中数据
        table.on("toolbar(post_opr)", function (obj) {
            var status = table.checkStatus(obj.config.id);
            layer.alert(JSON.stringify(status.data));
        });

        // 查询按钮点击事件
        form.on("submit(select)", function (data) {
            layer.alert(JSON.stringify(data.field));
        })
    });

</script>
<style>
    .user_search_main form .layui-input-inline {
        margin: 5px 0;
    }
</style>
<body>
<div class="header_nav">
    <a href="/simpleBook/houtai/index.html" target="rightFrame">主页</a>
</div>
<div class="layui-card" style="height: 60%; width: 99%;margin: 0 auto;margin-top: 15px">
    <div class="layui-card-header">
        <p class="">文章搜索</p>
    </div>
    <div class="layui-card-body">
        <div class="user_div">
            <div class="user_search_main" style="margin-top: 10px;margin-bottom: 15px">
                <form action="" class="layui-form">

                    <div class="layui-input-inline">
                        <input type="text" name="pid" placeholder="文章编号" autocomplete="off" class="layui-input"/>
                    </div>
                    <div class="layui-input-inline">
                        <input type="text" name="uid" id="uId" placeholder="用户编号" class="layui-input"
                               autocomplete="off"/>
                    </div>
                    <div class="layui-input-inline">
                        <input type="text" name="title" id="title" placeholder="文章标题" class="layui-input"
                               autocomplete="off"/>
                    </div>
                    <div class="layui-input-inline">
                        <input type="data" class="layui-input" name="sendDate" id="startDate"
                               placeholder="发帖时间(yyyy-MM-dd)" autocomplete="off">
                    </div>

                    <div class="layui-input-inline">
                        <input type="data" class="layui-input" name="endDate" id="endDate"
                               placeholder="截止时间(yyyy-MM-dd)" autocomplete="off">
                    </div>

                    <button type="button" lay-filter="select" lay-submit class="layui-btn layui-btn-normal">查询</button>
                </form>
            </div>

            <table id="postList" lay-filter="post_opr" class="layui-hide"></table>
        </div>
    </div>
</div>
</body>
</html>